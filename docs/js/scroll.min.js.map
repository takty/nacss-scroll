{"version":3,"sources":["scroll.js"],"names":["window","NS","setClass","tar","cls","enabled","val","key","substr","startsWith","dataset","c","join","classList","add","remove","resizeListeners","onResize","fn","doFirst","push","isRunning","args","requestAnimationFrame","throttle","onIntersect","targets","threshold","vs","Array","length","fill","tm","Map","forEach","t","i","set","mt","io","st","s","getComputedStyle","document","documentElement","parseInt","scrollPaddingTop","getScrollOffset","clearTimeout","setTimeout","disconnect","IntersectionObserver","es","e","get","target","isIntersecting","rootMargin","observe","init","addEventListener","l","passive","scroll","cs","opts","Object","assign","styleScroll","styleVisible"],"mappings":"AAUAA,OAAM,MAAYA,OAAM,OAAa,GAGrC,SAAWC,GAqBV,SAASC,EAASC,EAAKC,EAAKC,GAAU,EAAMC,EAAM,IACjD,MAAMC,EAAMH,EAAII,OAAO,GACvB,GAAIJ,EAAIK,WAAW,KACdJ,EACHF,EAAIO,QAAQH,GAAOD,SAEZH,EAAIO,QAAQH,OAEd,CACN,MAAMI,EAAI,CAACJ,EAAKD,GAAKM,KAAK,KACtBP,EACHF,EAAIU,UAAUC,IAAIH,GAElBR,EAAIU,UAAUE,OAAOJ,IA4CxB,MAAMK,EAAkB,GAExB,SAASC,EAASC,EAAIC,GAAU,GAC3BA,GAASD,IACbF,EAAgBI,KAhBjB,SAAkBF,GACjB,IAAIG,EACJ,MAAO,IAAIC,KACND,IACJA,GAAY,EACZE,uBAAsB,KACrBF,GAAY,EACZH,KAAMI,QASaE,CAASN,IAa/B,SAASO,EAAYP,EAAIQ,EAASC,GACjC,MAAMC,EAAKC,MAAMH,EAAQI,QAAQC,MAAK,GAChCC,EAAK,IAAIC,IACfP,EAAQQ,SAAQ,CAACC,EAAGC,IAAMJ,EAAGK,IAAIF,EAAGC,KAWpC,IAAIE,EAAK,EACLC,EAAK,KACLC,EAAK,KACTvB,GAAS,KACRqB,GAxDF,WACC,MAAMG,EAAIC,iBAAiBC,SAASC,iBACpC,OAAOC,SAASJ,EAAEK,kBAsDXC,GACFP,GAAIQ,aAAaR,GACrBA,EAAKS,YAAW,KACXV,GAAIA,EAAGW,aACXX,EAjBF,WACC,MAAMA,EAAK,IAAIY,sBAAsBC,IACpC,IAAK,MAAMC,KAAKD,EAAIxB,EAAGI,EAAGsB,IAAID,EAAEE,SAAWF,EAAEG,eAC7CtC,EAAGU,KAED,CAAE6B,WAAa,GAAEnB,wBAA0BX,UAAAA,IAC9C,IAAK,MAAMQ,KAAKT,EAASa,EAAGmB,QAAQvB,GACpC,OAAOI,EAUDoB,KACH,QACD,GAlCJhB,SAASiB,iBAAiB,oBAAoB,KAC7C5D,OAAO4D,iBAAiB,UAAU,KACjC,IAAK,MAAMC,KAAK7C,EAAiB6C,MAC/B,CAAEC,SAAS,OAmEf7D,EAAG8D,OAtBH,SAAoBC,EAAIC,EAAO,IACZ,IAAdD,EAAGlC,SAEPmC,EAAOC,OAAOC,OAAO,CACpBC,YAAc,YACdC,aAAc,oBACZJ,GAEHxC,GACA,SAAqBG,GACpB,IAAK,IAAIQ,EAAI,EAAGA,EAAI4B,EAAGlC,OAAQM,GAAK,EAC/BR,EAAGQ,IAAIlC,EAAS8D,EAAG5B,GAAI6B,EAAI,gBAHRD,EAAI,IAO7BhE,OAAO4D,iBAAiB,eAAe,KACtC,IAAK,MAAMjD,KAAKqD,EACf9D,EAASS,EAAGsD,EAAI,mBAtJpB,CA6JGjE,OAAM","file":"scroll.min.js","sourcesContent":["/**\n *\n * Scroll Style (JS)\n *\n * @author Takuto Yanagida\n * @version 2021-11-11\n *\n */\n\n\nwindow['NACSS'] = window['NACSS'] || {};\n\n\n(function (NS) {\n\n\t/**\n\t *\n\t * Style Class Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-11\n\t *\n\t */\n\t\n\t\n\tfunction hasClass(tar, cls) {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn tar.dataset[key] !== undefined;\n\t\t} else {\n\t\t\treturn tar.classList.contains(key);\n\t\t}\n\t}\n\t\n\tfunction setClass(tar, cls, enabled = true, val = '') {\n\t\tconst key = cls.substr(1);\n\t\tif (cls.startsWith(':')) {\n\t\t\tif (enabled) {\n\t\t\t\ttar.dataset[key] = val;\n\t\t\t} else {\n\t\t\t\tdelete tar.dataset[key];\n\t\t\t}\n\t\t} else {\n\t\t\tconst c = [key, val].join('-');\n\t\t\tif (enabled) {\n\t\t\t\ttar.classList.add(c);\n\t\t\t} else {\n\t\t\t\ttar.classList.remove(c);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction getSelector(cls) {\n\t\tif (cls.startsWith(':')) {\n\t\t\treturn `*[data-${cls.substr(1).replace(/([A-Z])/g, c => '-' + c.charAt(0).toLowerCase())}]`;\n\t\t} else {\n\t\t\treturn `*${cls}`;\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t * Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-11\n\t *\n\t */\n\t\n\t\n\tfunction getScrollOffset() {\n\t\tconst s = getComputedStyle(document.documentElement);\n\t\treturn parseInt(s.scrollPaddingTop);\n\t}\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction throttle(fn) {\n\t\tlet isRunning;\n\t\treturn (...args) => {\n\t\t\tif (isRunning) return;\n\t\t\tisRunning = true;\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tisRunning = false;\n\t\t\t\tfn(...args);\n\t\t\t});\n\t\t};\n\t}\n\t\n\tconst resizeListeners = [];\n\t\n\tfunction onResize(fn, doFirst = false) {\n\t\tif (doFirst) fn();\n\t\tresizeListeners.push(throttle(fn));\n\t}\n\t\n\tdocument.addEventListener('DOMContentLoaded', () => {\n\t\twindow.addEventListener('resize', () => {\n\t\t\tfor (const l of resizeListeners) l();\n\t\t}, { passive: true });\n\t});\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction onIntersect(fn, targets, threshold) {\n\t\tconst vs = Array(targets.length).fill(false);\n\t\tconst tm = new Map();\n\t\ttargets.forEach((t, i) => tm.set(t, i));\n\t\n\t\tfunction init() {\n\t\t\tconst io = new IntersectionObserver((es) => {\n\t\t\t\tfor (const e of es) vs[tm.get(e.target)] = e.isIntersecting;\n\t\t\t\tfn(vs);\n\t\t\t\t// console.log(vs);\n\t\t\t}, { rootMargin: `${mt}px 10000% 0px 10000%`, threshold });\n\t\t\tfor (const t of targets) io.observe(t);\n\t\t\treturn io;\n\t\t}\n\t\tlet mt = 0;\n\t\tlet io = null;\n\t\tlet st = null;\n\t\tonResize(() => {\n\t\t\tmt = -getScrollOffset();\n\t\t\tif (st) clearTimeout(st);\n\t\t\tst = setTimeout(() => {\n\t\t\t\tif (io) io.disconnect();\n\t\t\t\tio = init();\n\t\t\t}, 100);\n\t\t}, true);\n\t}\n\t\n\n\t/**\n\t *\n\t * Scroll Effect\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-10-25\n\t *\n\t */\n\t\n\t\n\tfunction initialize(cs, opts = {}) {\n\t\tif (cs.length === 0) return;\n\t\n\t\topts = Object.assign({\n\t\t\tstyleScroll : ':ncScroll',\n\t\t\tstyleVisible: ':ncScrollVisible',\n\t\t}, opts);\n\t\n\t\tonIntersect(doIntersect, cs, 0.5);\n\t\tfunction doIntersect(vs) {\n\t\t\tfor (let i = 0; i < cs.length; i += 1) {\n\t\t\t\tif (vs[i]) setClass(cs[i], opts['styleVisible']);\n\t\t\t}\n\t\t}\n\t\n\t\twindow.addEventListener('beforeprint', () => {\n\t\t\tfor (const c of cs) {\n\t\t\t\tsetClass(c, opts['styleVisible']);\n\t\t\t}\n\t\t});\n\t}\n\t\n\tNS.scroll = initialize;\n\n})(window['NACSS']);\n"]}